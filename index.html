<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Personal Expense Tracker</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<style>
  :root {
    --primary-color: #0a95b1;
    --secondary-color: #6c757d;
    --success-color: #28a745;
    --info-color: #17a2b8;
    --warning-color: #ffc107;
    --danger-color: #dc3545;
    --light-bg: #f8f9fa;
    --dark-text: #343a40;
    --muted-text: #6c757d;
  }

  body { 
    background: var(--light-bg);
    color: var(--dark-text);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  }
  
  .navbar {
    background-color: var(--primary-color) !important;
  }

  .card {
    border-radius: 1rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), box-shadow 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  .card:hover { 
    transform: translateY(-5px); 
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
  }

  .card-header {
    background-color: var(--primary-color);
    color: #fff;
    border-radius: 1rem 1rem 0 0 !important;
    font-weight: bold;
    border-bottom: none;
  }

  #expenseList li {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.5s ease-in-out;
  }

  #expenseList li.show {
    opacity: 1;
    transform: translateY(0);
  }

  .badge-category { 
    text-transform: uppercase; 
    font-size: 0.7rem; 
    padding: 0.4em 0.8em; 
    border-radius: 50rem;
    font-weight: 600;
  }

  .nav-link.active {
    font-weight: bold;
    border-bottom: 2px solid #fff;
    transition: all 0.3s;
  }

  .btn-success, .btn-danger {
    font-weight: 600;
    transition: background-color 0.3s;
  }

  .progress-bar {
    transition: width 0.5s ease-in-out;
  }
</style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark shadow-sm">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Expense Tracker</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link active" href="#" data-target="dashboard">Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" href="#" data-target="report">Reports</a></li>
      </ul>
    </div>
  </div>
</nav>

<section id="dashboard" class="container py-5">
  <div class="row g-4">
    <div class="col-lg-5">
      <div class="card shadow-sm border-0">
        <div class="card-header fw-bold">Add Expense</div>
        <div class="card-body">
          <div class="mb-3">
            <label for="monthlyBudget" class="form-label">Monthly Budget (₹)</label>
            <input type="number" class="form-control" id="monthlyBudget" value="5000">
          </div>
          <form id="expenseForm">
            <div class="mb-3">
              <label for="expenseName" class="form-label">Expense Name</label>
              <input type="text" class="form-control" id="expenseName" required>
            </div>
            <div class="mb-3">
              <label for="expenseDate" class="form-label">Date</label>
              <input type="date" class="form-control" id="expenseDate" required>
            </div>
            <div class="mb-3">
              <label for="expenseCategory" class="form-label">Category</label>
              <select class="form-select" id="expenseCategory" required>
                <option value="Food">Food</option>
                <option value="Travel">Travel</option>
                <option value="Shopping">Shopping</option>
                <option value="Bills">Bills</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="expenseAmount" class="form-label">Amount</label>
              <input type="number" class="form-control" id="expenseAmount" required>
            </div>
            <button type="submit" class="btn btn-success w-100"><i class="bi bi-plus-circle"></i> Add Expense</button>
          </form>
        </div>
      </div>
    </div>

    <div class="col-lg-7">
      <div class="card shadow-sm border-0">
        <div class="card-header fw-bold d-flex justify-content-between align-items-center">
          <span>Expense List</span>
          <select id="filterCategory" class="form-select w-auto">
            <option value="All">All</option>
            <option value="Food">Food</option>
            <option value="Travel">Travel</option>
            <option value="Shopping">Shopping</option>
            <option value="Bills">Bills</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div class="card-body">
          <ul id="expenseList" class="list-group mb-3"></ul>
          <h5 class="text-end">Total: ₹<span id="dashboardTotal">0</span></h5>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="report" class="container py-5" style="display:none;">
  <div class="row g-4 mb-4">
    <div class="col-lg-12">
      <div class="card shadow-sm border-0">
        <div class="card-header fw-bold">Budget Summary</div>
        <div class="card-body">
          <p class="mb-1">Monthly Budget: ₹<span id="reportBudget">0</span></p>
          <p class="mb-1">Total Expenses: ₹<span id="reportExpenses">0</span></p>
          <p class="mb-3">Remaining Amount / Savings: ₹<span id="reportRemaining">0</span></p>
          <div class="progress" style="height:25px; border-radius: 50rem;">
            <div id="budgetProgress" class="progress-bar" role="progressbar" style="width:0%"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-4">
    <div class="col-lg-6">
      <div class="card shadow-sm border-0">
        <div class="card-header fw-bold">Category-wise Expenses</div>
        <div class="card-body">
          <canvas id="categoryChart" height="250"></canvas>
        </div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card shadow-sm border-0">
        <div class="card-header fw-bold">Expense Breakdown (%)</div>
        <div class="card-body">
          <canvas id="breakdownChart" height="250"></canvas>
        </div>
      </div>
    </div>
  </div>
</section>

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let expenses = JSON.parse(localStorage.getItem('expenses'))||[];
let totalAmount = 0;
let monthlyBudget = parseFloat($('#monthlyBudget').val());
const categoryColors = {
  Food: '#E91E63',
  Travel: '#03A9F4',
  Shopping: '#FF9800',
  Bills: '#4CAF50',
  Other: '#673AB7'
};

function saveToLocal(){ localStorage.setItem('expenses',JSON.stringify(expenses)); }

function updateBudgetSummary(){
  totalAmount = expenses.reduce((sum,e) => sum + parseFloat(e.amount), 0);
  const remaining = monthlyBudget - totalAmount;
  $('#reportBudget').text(monthlyBudget);
  $('#reportExpenses').text(totalAmount);
  $('#reportRemaining').text(remaining);
  const progressPercent = Math.min((totalAmount/monthlyBudget)*100, 100);
  $('#budgetProgress').css('width', progressPercent + '%').text(Math.round(progressPercent) + '%').toggleClass('bg-success', remaining >= 0).toggleClass('bg-danger', remaining < 0);
}

function renderExpenses(filter='All'){
  $('#expenseList').empty();
  let filteredExpenses = expenses.filter(e => filter === 'All' || e.category === filter);
  let filteredTotal = 0;

  filteredExpenses.forEach((e, i) => {
    filteredTotal += parseFloat(e.amount);
    const li = $(`
      <li class="list-group-item d-flex justify-content-between align-items-center shadow-sm mb-2 rounded-3">
        <div>
          <span class="fw-bold">${e.name}</span> - ₹${e.amount} 
          <span class="badge badge-category ms-2 text-white" style="background-color:${categoryColors[e.category]};">${e.category}</span>
          <small class="text-muted ms-2">${e.date}</small>
        </div>
        <button class="btn btn-sm btn-danger"><i class="bi bi-trash"></i></button>
      </li>
    `);
    
    li.find('button').click(() => {
      // Find the original index of the expense to remove it from the main array
      const originalIndex = expenses.findIndex(exp => exp.name === e.name && exp.date === e.date && exp.amount === e.amount);
      if (originalIndex !== -1) {
        expenses.splice(originalIndex, 1);
        saveToLocal();
        renderExpenses($('#filterCategory').val());
        updateCharts();
        updateBudgetSummary();
      }
    });

    $('#expenseList').append(li); 
    setTimeout(() => li.addClass('show'), 50 * i);
  });

  $('#dashboardTotal').text(filteredTotal);
}

$('#expenseForm').submit(function(e){
  e.preventDefault();
  const name = $('#expenseName').val();
  const date = $('#expenseDate').val();
  const category = $('#expenseCategory').val();
  const amount = parseFloat($('#expenseAmount').val());
  expenses.push({name, date, category, amount});
  saveToLocal();
  renderExpenses($('#filterCategory').val());
  updateCharts();
  updateBudgetSummary();
  this.reset();
});

$('#monthlyBudget').on('input', function(){ monthlyBudget = parseFloat($(this).val()) || 0; updateBudgetSummary(); });
$('#filterCategory').change(() => renderExpenses($('#filterCategory').val()));

// Navigation
$('.nav-link').click(function(e){
  e.preventDefault();
  $('.nav-link').removeClass('active');
  $(this).addClass('active');
  const target = $(this).data('target');
  $('section').hide(); $('#' + target).fadeIn();
  if (target === 'report') {
    updateCharts(); // Ensure charts are updated on navigation
  }
});

// Charts
const categoryChart = new Chart($('#categoryChart'),{type:'bar',data:{labels:[],datasets:[{label:'Expenses',data:[],backgroundColor:Object.values(categoryColors)}]}});
const breakdownChart = new Chart($('#breakdownChart'),{type:'doughnut',data:{labels:[],datasets:[{data:[],backgroundColor:Object.values(categoryColors)}]}});
function updateCharts(){
  const totals = {};
  Object.keys(categoryColors).forEach(c => totals[c] = 0); // Initialize all categories to 0
  expenses.forEach(e => totals[e.category] += e.amount);
  const labels = Object.keys(totals);
  const data = Object.values(totals);
  
  categoryChart.data.labels = labels;
  categoryChart.data.datasets[0].data = data;
  categoryChart.data.datasets[0].backgroundColor = labels.map(l => categoryColors[l] || '#888');
  categoryChart.update();
  
  breakdownChart.data.labels = labels;
  breakdownChart.data.datasets[0].data = data;
  breakdownChart.data.datasets[0].backgroundColor = labels.map(l => categoryColors[l] || '#888');
  breakdownChart.update();
}

// Initialize
renderExpenses();
updateBudgetSummary();
updateCharts();
</script>
</body>
</html>